<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>한글 ↔ 건어 변환기 (11307 → 8진)</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      padding: 30px;
    }
    textarea {
      width: 100%;
      height: 120px;
      font-size: 16px;
      padding: 10px;
      box-sizing: border-box;
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    .output {
      margin-top: 20px;
      background: white;
      padding: 15px;
      min-height: 80px;
      white-space: pre-wrap;
      border: 1px solid #ccc;
    }
    hr { margin: 40px 0; }
  </style>
</head>
<body>

<h2>문자 → 건어</h2>
<textarea id="inputText"></textarea>
<button onclick="runEncrypt()">변환</button>
<div class="output" id="outputText"></div>

<hr>

<h2>건어 → 문자</h2>
<textarea id="cipherInput"></textarea>
<button onclick="runDecrypt()">변환</button>
<div class="output" id="decryptOutput"></div>

<script>
/* ================= 문자 테이블 ================= */

const charList = [];

// 한글 완성형
for (let i = 0xAC00; i <= 0xD7A3; i++) {
  charList.push(String.fromCharCode(i));
}

// 한글 자모
for (let i = 0x3131; i <= 0x3163; i++) {
  charList.push(String.fromCharCode(i));
}

// 영어
for (let i = 65; i <= 90; i++) charList.push(String.fromCharCode(i));
for (let i = 97; i <= 122; i++) charList.push(String.fromCharCode(i));

// 숫자
for (let i = 48; i <= 57; i++) charList.push(String.fromCharCode(i));

// ASCII 특수문자
for (let i = 33; i <= 47; i++) charList.push(String.fromCharCode(i));
for (let i = 58; i <= 64; i++) charList.push(String.fromCharCode(i));
for (let i = 91; i <= 96; i++) charList.push(String.fromCharCode(i));
for (let i = 123; i <= 126; i++) charList.push(String.fromCharCode(i));

// 공백
charList.push(" ");

const BASE = BigInt(charList.length); // 11307

const charToIndex = {};
charList.forEach((c, i) => charToIndex[c] = BigInt(i));

/* ================= 건어 8진 매핑 ================= */

const digitMap = ["김","건","긁","빌","깋","히","하","알"];
const reverseDigitMap = {
  "김":0,"건":1,"긁":2,"빌":3,"깋":4,"히":5,"하":6,"알":7
};

/* ================= 암호화 ================= */

function encrypt(text) {
  let num = 0n;

  for (let ch of text) {
    if (!(ch in charToIndex)) continue;
    num = num * BASE + charToIndex[ch];
  }

  if (num === 0n) return "";

  let out = "";
  while (num > 0n) {
    out = digitMap[Number(num % 8n)] + out;
    num /= 8n;
  }
  return out;
}

/* ================= 복호화 ================= */

function decrypt(cipher) {
  let num = 0n;
  for (let ch of cipher) {
    if (!(ch in reverseDigitMap)) continue;
    num = num * 8n + BigInt(reverseDigitMap[ch]);
  }

  let out = "";
  while (num > 0n) {
    const idx = num % BASE;
    out = charList[Number(idx)] + out;
    num /= BASE;
  }
  return out;
}

/* ================= 실행 ================= */

function runEncrypt() {
  document.getElementById("outputText").innerText =
    encrypt(document.getElementById("inputText").value);
}

function runDecrypt() {
  document.getElementById("decryptOutput").innerText =
    decrypt(document.getElementById("cipherInput").value);
}
</script>

</body>
</html>
