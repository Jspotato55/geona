<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>한글 ↔ 가나다라마바사 암호</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    textarea {
      width: 100%;
      height: 80px;
      margin-bottom: 10px;
    }
    button {
      margin-bottom: 20px;
    }
    .result {
      white-space: pre-wrap;
      background: #f5f5f5;
      padding: 10px;
    }
  </style>
</head>
<body>

<h2>한글 → 가나다라마바사 암호</h2>
<textarea id="encodeInput" placeholder="한글 입력"></textarea>
<button onclick="encode()">변환</button>
<div id="encodeResult" class="result"></div>

<hr>

<h2>가나다라마바사 암호 → 한글</h2>
<textarea id="decodeInput" placeholder="가나다라마바사 암호 입력 (공백으로 구분)"></textarea>
<button onclick="decode()">변환</button>
<div id="decodeResult" class="result"></div>

<script>
  const digits = ['가', '나', '다', '라', '마', '바', '사'];
  const digitMap = Object.fromEntries(digits.map((d, i) => [d, i]));

  function charToNumber(ch) {
    const code = ch.codePointAt(0);

    if (code >= 0xAC00 && code <= 0xD7A3) {
      return code - 0xAC00;
    }
    if (code >= 0x3131 && code <= 0x314E) {
      return 11172 + (code - 0x3131);
    }
    if (code >= 0x314F && code <= 0x3163) {
      return 11186 + (code - 0x314F);
    }
    return null;
  }

  function numberToChar(num) {
    if (num >= 0 && num <= 11171) {
      return String.fromCodePoint(0xAC00 + num);
    }
    if (num >= 11172 && num <= 11185) {
      return String.fromCodePoint(0x3131 + (num - 11172));
    }
    if (num >= 11186 && num <= 11206) {
      return String.fromCodePoint(0x314F + (num - 11186));
    }
    return '';
  }

  function toBase7(num) {
    if (num === 0) return '가';
    let result = '';
    while (num > 0) {
      result = digits[num % 7] + result;
      num = Math.floor(num / 7);
    }
    return result;
  }

  function fromBase7(str) {
    let num = 0;
    for (const ch of str) {
      num = num * 7 + digitMap[ch];
    }
    return num;
  }

  function encode() {
    const input = document.getElementById('encodeInput').value;
    const output = [];

    for (const ch of input) {
      const num = charToNumber(ch);
      if (num !== null) {
        output.push(toBase7(num));
      }
    }

    document.getElementById('encodeResult').innerText =
      output.join(' ');
  }

  function decode() {
    const input = document.getElementById('decodeInput').value.trim();
    if (!input) {
      document.getElementById('decodeResult').innerText = '';
      return;
    }

    const parts = input.split(/\s+/);
    let result = '';

    for (const part of parts) {
      const num = fromBase7(part);
      result += numberToChar(num);
    }

    document.getElementById('decodeResult').innerText = result;
  }
</script>

</body>
</html>
