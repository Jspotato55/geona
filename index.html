<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>í•œê¸€ â†” ê°€ë‚˜ë¼ë§ˆë°”ì‚¬ ì•”í˜¸ ë³€í™˜ê¸°</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      padding: 30px;
    }

    h2 {
      margin-bottom: 10px;
    }

    textarea {
      width: 100%;
      height: 120px;
      font-size: 16px;
      padding: 10px;
      box-sizing: border-box;
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }

    .output {
      margin-top: 20px;
      background: white;
      padding: 15px;
      min-height: 80px;
      white-space: pre-wrap;
      border: 1px solid #ccc;
    }

    hr {
      margin: 40px 0;
    }
  </style>
</head>
<body>

  <!-- í•œê¸€ â†’ ì•”í˜¸ -->
  <h2>í•œê¸€ â†’ ê°€ë‚˜ë¼ë§ˆë°”ì‚¬ ì•”í˜¸</h2>

  <textarea id="inputText" placeholder="í•œê¸€ì„ ì…ë ¥í•´ ì¤˜ (ê°€~í£, ã„±~ã…, ã…~ã…£ë§Œ ì¸ì‹)"></textarea>
  <br>
  <button onclick="runEncrypt()">ë³€í™˜</button>

  <div class="output" id="outputText"></div>

  <hr>

  <!-- ì•”í˜¸ â†’ í•œê¸€ -->
  <h2>ê°€ë‚˜ë¼ë§ˆë°”ì‚¬ ì•”í˜¸ â†’ í•œê¸€</h2>

  <textarea id="cipherInput" placeholder="ê°€ ë‚˜ ë‹¤ ë¼ ë§ˆ ë°” ì‚¬ ë¡œ ì´ë£¨ì–´ì§„ ì•”í˜¸ë¥¼ ì…ë ¥í•´ ì¤˜ (ê¸€ì ë‹¨ìœ„ëŠ” ê³µë°±ìœ¼ë¡œ êµ¬ë¶„)"></textarea>
  <br>
  <button onclick="runDecrypt()">ë³€í™˜</button>

  <div class="output" id="decryptOutput"></div>

  <script>
    const baseHangulStart = 0xAC00; // ê°€
    const baseHangulEnd   = 0xD7A3; // í£

    const jamoStart = 0x3131; // ã„±
    const jamoEnd   = 0x3163; // ã…£

    const jamoOffset = 1421;

    // ğŸ”¥ 7ì§„ë²• ë§¤í•‘
    const digitMap = ["ê°€", "ë‚˜", "ë‹¤", "ë¼", "ë§ˆ", "ë°”", "ì‚¬"];

    const reverseDigitMap = {
      "ê°€": "0",
      "ë‚˜": "1",
      "ë‹¤": "2",
      "ë¼": "3",
      "ë§ˆ": "4",
      "ë°”": "5",
      "ì‚¬": "6"
    };

    function encryptHangul(input) {
      let result = [];

      for (let ch of input) {
        const code = ch.charCodeAt(0);
        let number = null;

        if (code >= baseHangulStart && code <= baseHangulEnd) {
          number = code - baseHangulStart;
        } else if (code >= jamoStart && code <= jamoEnd) {
          number = code - jamoOffset;
        } else {
          continue;
        }

        // ğŸ”¥ 7ì§„ë²• ë³€í™˜
        let base7 = number.toString(7);
        let encoded = "";

        for (let digit of base7) {
          encoded += digitMap[Number(digit)];
        }

        result.push(encoded);
      }

      return result.join(" ");
    }

    function decryptCipher(input) {
      let parts = input.trim().split(/\s+/);
      let result = "";

      for (let part of parts) {
        let base7 = "";

        for (let ch of part) {
          if (!(ch in reverseDigitMap)) {
            base7 = null;
            break;
          }
          base7 += reverseDigitMap[ch];
        }

        if (base7 === null) continue;

        // ğŸ”¥ 7ì§„ë²• ë³µì›
        let number = parseInt(base7, 7);

        if (number >= 0 && number <= 11171) {
          result += String.fromCharCode(number + baseHangulStart);
        } else if (number >= 11172 && number <= 11222) {
          result += String.fromCharCode(number + jamoOffset);
        }
      }

      return result;
    }

    function runEncrypt() {
      const input = document.getElementById("inputText").value;
      document.getElementById("outputText").innerText = encryptHangul(input);
    }

    function runDecrypt() {
      const input = document.getElementById("cipherInput").value;
      document.getElementById("decryptOutput").innerText = decryptCipher(input);
    }
  </script>

</body>
</html>
